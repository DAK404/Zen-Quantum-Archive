NOTE

THE VERSION USED HERE IS THE DEPRECATED UPDATE LOGIC.

IF THE IMPROVED VERSION EXISTS, PLEASE UPLOAD THE NEW ONE AND DELETE THIS.
